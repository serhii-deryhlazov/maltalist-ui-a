<div id="listing-details" *ngIf="listing">
  <div class="listing-images">
    <div class="carousel-container">
      <div class="carousel-main">
        <img
          id="carousel-big-img"
          [src]="currentImage"
          alt="Listing image"
          *ngIf="currentImage !== '/assets/img/placeholder.png'">
        <div *ngIf="currentImage === '/assets/img/placeholder.png'" class="no-image">
          No images available
        </div>
      </div>
      <div class="carousel-thumbnails" *ngIf="pictures.length > 1">
        <img
          *ngFor="let pic of pictures; let i = index"
          [src]="pic"
          class="carousel-thumb"
          [class.selected]="i === currentImageIndex"
          (click)="selectImage(i)"
          alt="Thumbnail {{ i + 1 }}">
      </div>
    </div>
  </div>

  <div class="listing-details-info">
    <h2>{{ listing.title }}</h2>
    <p class="price">â‚¬{{ listing.price }}</p>
    <p class="category"><strong>Category:</strong> {{ listing.category }}</p>
    <p class="location"><strong>Location:</strong> {{ listing.location }}</p>
    <p class="description">{{ listing.description }}</p>

    <div class="listing-meta">
      <div>
        <span class="material-symbols-outlined">schedule</span>
        {{ formatDate(listing.createdAt) }}
      </div>
      <div *ngIf="listing.isPromoted" class="promoted-badge">Promoted</div>
    </div>

    <div class="listing-buttons">
      <button
        id="listing-contact"
        (click)="contactSeller()"
        *ngIf="!isOwner">
        <span class="material-symbols-outlined">contact_mail</span>
        Contact Seller
      </button>

      <div *ngIf="isOwner" class="owner-buttons">
        <button id="edit-listing-btn" (click)="editListing()">
          <span class="material-symbols-outlined">edit</span>
          Edit Listing
        </button>
        <button id="delete-listing-btn" (click)="deleteListing()">
          <span class="material-symbols-outlined">delete</span>
          Delete Listing
        </button>
        <button id="promote-listing-btn" (click)="promoteListing()">
          <span class="material-symbols-outlined">campaign</span>
          Promote Listing
        </button>
      </div>
    </div>

    <div *ngIf="showPromoteModal" class="modal">
      <div class="modal-content">
        <h3>Promote Listing</h3>
        <select [(ngModel)]="selectedType">
          <option value="week">1 Week - 2 EUR</option>
          <option value="month">1 Month - 5 EUR</option>
        </select>
        <button (click)="confirmPromotion()">Confirm & Pay</button>
        <button (click)="cancelPromotion()">Cancel</button>
      </div>
    </div>

    <button class="copy-btn" (click)="copyToClipboard()">
      <span class="material-symbols-outlined">content_copy</span>
      Copy Link
    </button>
  </div>
</div>

<div *ngIf="!listing" class="loading">
  <p>Loading listing details...</p>
</div>
